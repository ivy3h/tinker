"""
Prompt templates for multilingual reasoning tasks.

This module contains all prompt templates used throughout the multilingual reasoning pipeline,
including templates for verification, translation, classification, and language-specific prompts.
"""

# ─────────────────────── Verification Templates ───────────────────────

verify_answer_template = """You are an expert verifier. You will be given a problem, the ground truth solution(s), and a solution generated by a language model. Your task is to determine if the model's final solution matches any of the ground truth solutions, regardless of reasoning or correctness of steps. If it matches, it is correct. First reason step-by-step and then output your answer. Your final answer must be strictly either True or False in the following format:
Correct: BOOLEAN
Here are the details for your task:
Problem:
{problem}
Ground Truth Solution(s):
{gt_solution}
Model Solution:
{model_solution}
Your answer:"""

# ─────────────────────── Translation Templates ───────────────────────

translate_template = """Your job is to return a translated version of the English text.
* Translate to {target_lang}.
* The translation must be fluent, easy to read by native speakers.
* Do not solve the prompt translate it.
* You must preserve all details including math notations (latex), code, and special tokens (e.g., <think>).
* The math notations, code, and special tokens must not be translated, keep it as is.
* Return your translation in the following format.
<translation>
...translated text...
</translation>
The following is the source text for your task:
<English>
{source_text}
</English>"""

# ─────────────────────── Error Classification Templates ───────────────────────

error_classification_template = """You are an expert at identifying critical errors in model-generated responses. For each case, you will receive:
1. A set of rubrics defining distinct errors.
2. A problem statement and a model-generated response that is incorrect.

**Your task:**
Identify which error, as defined by the rubrics, is the most critical in the model response. You should only select the single error that was most influential in leading to the model answer being incorrect. Your final answer must be a valid JSON object in the format below, only one category should be present:
```json
{
"Problem Comprehension": {"present": 1|0, "explanation": "..."},
"Conceptual": … ,
"Reasoning": … ,
"Calculation": … ,
"Output Generation": …
}
```

---

Rubrics:
### 1. **Problem Comprehension Error**
This error occurs when the model **misunderstands what it's being asked to do**. The reasoning can't be correct if it's aimed at the wrong goal.

* **Definition**: The model incorrectly interprets the problem's objective, constraints, variables, or key terms.
* **Example**: Asked for the **perimeter** of a shape, the model calculates its **area**.

---

### 2. **Conceptual Error**
This error occurs when the model understands the goal but **lacks or misuses the necessary knowledge** to devise a correct plan.

* **Definition**: The model fails to apply or incorrectly applies a required fact, formula, theorem, or scientific principle.
* **Example**: Using the formula for a circle's area to find its circumference.

---

### 3. **Reasoning Error**
This is an error in the **logical flow** of the solution. The model understands the problem and may know the right concepts, but it connects them incorrectly.

* **Definition**: The model employs a flawed logical step, makes an invalid inference, or constructs an incorrect solution plan from correct concepts.
* **Example**: From "If A then B," incorrectly concluding "If B then A."

---

### 4. **Calculation Error**
This is a mechanical error in execution. The plan and logic are sound, but the math is wrong.

* **Definition**: All prior steps are correct, but the model makes an error in an arithmetic or symbolic computation.
* **Example**: Correctly setting up $x = 3 \\times 7$ but calculating the result as 22.

---

### 5. **Output Generation Error**
This error covers any case where the model fails to deliver the output correctly.

* **Definition**: The model fails to produce the output according to the task's explicit or implicit constraints. This includes issues with formatting (missing `\\boxed{}`), stability (repetitive loops), or adherence to instructions (wrong language).
* **Example**: Endlessly repeating "The next step is…".

Response to analyze:
{response}
End of response. Output your JSON object:"""

# ─────────────────────── Language-Specific Prompts ───────────────────────

LF_prefix_dict = {
    "English": "Please reason step by step, and put your final answer within \\boxed{}. Your thinking and final solution must be in English.",
    "Chinese": "请分步推理，并将最终答案放入 \\boxed{} 中。你的思考过程和最终解答必须为中文。",
    "French": "Veuillez raisonner étape par étape, et mettez votre réponse finale dans \\boxed{}. Votre raisonnement et votre solution finale doivent être en français.",
    "Japanese": "段階を追って論理的に説明し、最終的な答えは \\boxed{} で囲んでください。思考過程と最終的な解答は日本語で記述してください。",
    "Latvian": "Lūdzu, spriediet soli pa solim un gala atbildi ietveriet \\boxed{}. Jūsu domu gaitai un gala risinājumam jābūt latviešu valodā.",
    "Swahili": "Tafadhali eleza hoja zako hatua kwa hatua, na uweke jibu lako la mwisho ndani ya \\boxed{}. Mawazo yako na suluhisho la mwisho lazima yawe kwa Kiswahili.",
    "Telugu": "దయచేసి అంచెలంచెలుగా వివరించి, మీ తుది సమాధానాన్ని \\boxed{} లోపల పెట్టండి. మీ ఆలోచనా విధానం, తుది పరిష్కారం తప్పనిసరిగా తెలుగులో ఉండాలి.",
    "Thai": "โปรดแสดงวิธีทำทีละขั้นตอน และใส่คำตอบสุดท้ายใน \\boxed{} วิธีคิดและคำตอบสุดท้ายต้องเป็นภาษาไทย",
    "Afrikaans": "Redeneer asseblief stap vir stap, en plaas jou finale antwoord binne \\boxed{}. Jou denke en finale oplossing moet in Afrikaans wees.",
    "Marathi": "कृपया चरण-दर-चरण तर्क करा, आणि आपले अंतिम उत्तर \\boxed{} मध्ये ठेवा. तुमचे विचार आणि अंतिम समाधान मराठीत असणे आवश्यक आहे."
}

LF_no_boxed_prefix_dict = {
    "English": "Please reason step by step. Your thinking and final solution must be in English.",
    "Chinese": "请分步推理。你的思考过程和最终解答必须为中文。",
    "French": "Veuillez raisonner étape par étape. Votre raisonnement et votre solution finale doivent être en français.",
    "Japanese": "段階を追って論理的に説明してください。思考過程と最終的な解答は日本語で記述してください。",
    "Latvian": "Lūdzu, spriediet soli pa solim. Jūsu domu gaitai un gala risinājumam jābūt latviešu valodā.",
    "Swahili": "Tafadhali eleza hoja zako hatua kwa hatua. Mawazo yako na suluhisho la mwisho lazima yawe kwa Kiswahili.",
    "Telugu": "దయచేసి అంచెలంచెలుగా వివరించండి. మీ ఆలోచనా విధానం, తుది పరిష్కారం తప్పనిసరిగా తెలుగులో ఉండాలి.",
    "Thai": "โปรดแสดงวิธีทำทีละขั้นตอน วิธีคิดและคำตอบสุดท้ายต้องเป็นภาษาไทย",
    "Afrikaans": "Redeneer asseblief stap vir stap. Jou denke en finale oplossing moet in Afrikaans wees.",
    "Marathi": "कृपया चरण-दर-चरण तर्क करा. तुमचे विचार आणि अंतिम समाधान मराठीत असणे आवश्यक आहे."
}

LF_suffix_dict = {
    "English": "Okay, let me try to figure this out.",
    "Chinese": "好的，我来想办法。",
    "French": "D'accord, je vais essayer de trouver une solution.",
    "Japanese": "はい、やってみます。",
    "Latvian": "Labi, mēģināšu to noskaidrot.",
    "Swahili": "Sawa, wacha nijaribu kulitatua hili.",
    "Telugu": "సరే, నేను దీనిని కనుగొనడానికి ప్రయత్నిస్తాను.",
    "Thai": "โอเค จะลองหาวิธีดู",
    "Afrikaans": "Goed, laat ek dit probeer uitpluis.",
    "Marathi": "ठीक आहे, मी हे शोधण्याचा प्रयत्न करतो."
}

system_prompt_dict = {
   "English": "Please reason step by step, and put your final answer within \\boxed{}.",
   "Swahili": "Tafadhali toa hoja hatua kwa hatua, na uweke jibu lako la mwisho ndani ya \\boxed{}.",
   "Japanese": "ステップごとに順を追って説明し、最終的な答えを\\boxed{}の中に記述してください。",
   "French": "Veuillez raisonner étape par étape, et placez votre réponse finale dans \\boxed{}.",
   "Latvian": "Lūdzu, spriediet soli pa solim un ievietojiet savu galīgo atbildi \\boxed{}.",
   "Chinese": "请一步一步地进行推理，并将最终答案放在\\boxed{}内。",
   "Telugu": "దయచేసి దశలవారీగా తర్కించండి మరియు మీ తుది సమాధానాన్ని \\boxed{}లో ఉంచండి。",
   "Thai": "โปรดให้เหตุผลทีละขั้นตอน และใส่คำตอบสุดท้ายของคุณไว้ใน \\boxed{}",
   "Afrikaans": "Redeneer asseblief stap vir stap, en plaas jou finale antwoord binne \\boxed{}.",
   "Marathi": "कृपया पायरी-पायरीने तर्क करा, आणि तुमचे अंतिम उत्तर \\boxed{} मध्ये ठेवा."
}

# ─────────────────────── Language Mappings and Configurations ───────────────────────

SUPPORTED_LANGUAGES = {
    'en': 'English',
    'zh': 'Chinese',
    'fr': 'French', 
    'ja': 'Japanese',
    'lv': 'Latvian',
    'sw': 'Swahili',
    'te': 'Telugu',
    'th': 'Thai',
    'af': 'Afrikaans',
    'mr': 'Marathi'
}

LANGDETECT_MAPPING = {
    "English": "en",
    "French": "fr",
    "Swahili": "sw",
    "Japanese": "ja",
    "Chinese": "zh-cn",
    "Latvian": "lv",
    "Telugu": "te",
    "Thai": "th",
    "Afrikaans": "af",
    "Marathi": "mr"
}

# ─────────────────────── Dataset Configurations ───────────────────────

lang_dict = {
    "math500": ["English", "French", "Swahili", "Japanese", "Latvian", "Chinese", "Telugu", "Thai", "Afrikaans", "Marathi"],
    "aime2024": ["English", "French", "Swahili", "Japanese", "Latvian", "Chinese", "Telugu", "Thai", "Afrikaans", "Marathi"],
    "aime2025": ["English", "French", "Swahili", "Japanese", "Latvian", "Chinese", "Telugu", "Thai", "Afrikaans", "Marathi"],
    "aime-combined": ["English", "French", "Swahili", "Japanese", "Latvian", "Chinese", "Telugu", "Thai", "Afrikaans", "Marathi"],
    "mmlu": ["English", "French", "Swahili", "Japanese", "Chinese", "Telugu", "Thai", "Afrikaans", "Marathi"],
}